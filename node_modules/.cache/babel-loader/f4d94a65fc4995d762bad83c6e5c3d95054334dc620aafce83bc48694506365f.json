{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback}from'react';import{Heart,MessageCircle,Star,Coins,Settings,Users,Home,ShoppingBag,Coffee,TreePine,Hammer,Fish,Sparkles,X}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CozyTown=()=>{// World dimensions - much larger than screen\nconst WORLD_WIDTH=1600;const WORLD_HEIGHT=1200;const VIEWPORT_WIDTH=400;const VIEWPORT_HEIGHT=300;const[player,setPlayer]=useState({x:600,y:400,coins:150,level:1,xp:0,energy:100,avatar:'ðŸ˜Š',username:'NewPlayer',friends:12,inventory:[]});const[camera,setCamera]=useState({x:600-VIEWPORT_WIDTH/2,y:400-VIEWPORT_HEIGHT/2});// Smooth camera following with interpolation\nconst targetCameraRef=useRef({x:600-VIEWPORT_WIDTH/2,y:400-VIEWPORT_HEIGHT/2});const animationFrameRef=useRef(null);// Camera follows player with smooth movement\nuseEffect(()=>{const updateCamera=()=>{const targetX=player.x-VIEWPORT_WIDTH/2;const targetY=player.y-VIEWPORT_HEIGHT/2;// Clamp target camera to world bounds\nconst clampedTargetX=Math.max(0,Math.min(WORLD_WIDTH-VIEWPORT_WIDTH,targetX));const clampedTargetY=Math.max(0,Math.min(WORLD_HEIGHT-VIEWPORT_HEIGHT,targetY));targetCameraRef.current={x:clampedTargetX,y:clampedTargetY};};updateCamera();},[player.x,player.y]);// Smooth camera interpolation - more responsive\nuseEffect(()=>{const smoothCameraUpdate=()=>{setCamera(currentCamera=>{const dx=targetCameraRef.current.x-currentCamera.x;const dy=targetCameraRef.current.y-currentCamera.y;// More responsive interpolation - increased from 0.12 to 0.25\nconst smoothing=0.25;const newX=currentCamera.x+dx*smoothing;const newY=currentCamera.y+dy*smoothing;// Reduce threshold for stopping micro-movements - from 0.5 to 0.1\nif(Math.abs(dx)<0.1&&Math.abs(dy)<0.1){return{x:targetCameraRef.current.x,y:targetCameraRef.current.y};}return{x:newX,y:newY};});animationFrameRef.current=requestAnimationFrame(smoothCameraUpdate);};animationFrameRef.current=requestAnimationFrame(smoothCameraUpdate);return()=>{if(animationFrameRef.current){cancelAnimationFrame(animationFrameRef.current);}};},[]);const[ui,setUi]=useState({showChat:true,showInventory:false,showMenu:false,showQuests:false,selectedBuilding:null,showWelcome:true,showMiniMap:false,showSettings:false});const[gameState,setGameState]=useState({currentArea:'town_square',time:'day',weather:'sunny',activeQuest:null,chatMessages:[{id:1,sender:'System',message:'Welcome to Cozy Town! ðŸŒŸ',timestamp:'12:00'}],onlinePlayers:47,isMoving:false,soundEnabled:true});// Quest system\nconst[quests]=useState([{id:1,title:'First Steps',description:'Visit the Town Hall',reward:{coins:50,xp:20},completed:false},{id:2,title:'Coffee Break',description:'Buy coffee at the cafe',reward:{coins:30,xp:15},completed:false},{id:3,title:'Fishing Trip',description:'Catch a fish at the dock',reward:{coins:100,xp:50},completed:false}]);// NPCs positioned in the larger world\nconst[npcs]=useState([{id:1,name:'Mayor Jenkins',x:800,y:300,emoji:'ðŸ‘¨â€ðŸ’¼',dialogue:\"Welcome to Cozy Town! We're always looking for new residents!\"},{id:2,name:'Cafe Owner Luna',x:300,y:400,emoji:'ðŸ‘©â€ðŸ³',dialogue:\"Fresh coffee and treats! Come in and relax!\"},{id:3,name:'Shop Keeper Sam',x:1200,y:500,emoji:'ðŸ›ï¸',dialogue:\"Come see my wares! I have everything you need!\"},{id:4,name:'Fisher Bob',x:200,y:800,emoji:'ðŸŽ£',dialogue:\"The fish are biting today! Want to try your luck?\"},{id:5,name:'Woodcutter Alice',x:1300,y:200,emoji:'ðŸª“',dialogue:\"Need some wood? I can teach you the trade!\"}]);const[otherPlayers]=useState([{id:1,username:'CoffeeLover23',x:400,y:450,avatar:'â˜•',level:5},{id:2,username:'TreeHugger',x:900,y:350,avatar:'ðŸŒ±',level:3},{id:3,username:'FishMaster',x:250,y:750,avatar:'ðŸŸ',level:8},{id:4,username:'Explorer99',x:1100,y:300,avatar:'ðŸ—ºï¸',level:6}]);const gameRef=useRef(null);const moveIntervalRef=useRef(null);const[controls,setControls]=useState({up:false,down:false,left:false,right:false});// Buildings positioned in the larger world\nconst buildings=[{id:'cafe',name:'Cozy Cafe',x:250,y:350,width:120,height:100,emoji:'â˜•',color:'#8B4513'},{id:'shop',name:'General Store',x:1150,y:450,width:140,height:110,emoji:'ðŸª',color:'#FF6B6B'},{id:'park',name:'Central Park',x:750,y:150,width:200,height:160,emoji:'ðŸŒ³',color:'#4ECDC4'},{id:'townhall',name:'Town Hall',x:700,y:500,width:160,height:120,emoji:'ðŸ›ï¸',color:'#45B7D1'},{id:'dock',name:'Fishing Dock',x:50,y:700,width:180,height:100,emoji:'ðŸŽ£',color:'#4682B4'},{id:'forest',name:'Dark Forest',x:1200,y:100,width:200,height:180,emoji:'ðŸŒ²',color:'#228B22'},{id:'mine',name:'Crystal Mine',x:1400,y:800,width:150,height:120,emoji:'â›ï¸',color:'#696969'}];// Handle player movement with smooth continuous movement\nconst movePlayer=useCallback((deltaX,deltaY)=>{setPlayer(prev=>{const newX=Math.max(30,Math.min(WORLD_WIDTH-30,prev.x+deltaX));const newY=Math.max(30,Math.min(WORLD_HEIGHT-30,prev.y+deltaY));return{...prev,x:newX,y:newY};});},[]);// D-Pad movement system\nuseEffect(()=>{const moveSpeed=3;// Pixels per frame\nconst gameLoop=()=>{if(controls.up||controls.down||controls.left||controls.right){let deltaX=0;let deltaY=0;if(controls.left)deltaX-=moveSpeed;if(controls.right)deltaX+=moveSpeed;if(controls.up)deltaY-=moveSpeed;if(controls.down)deltaY+=moveSpeed;// Diagonal movement should be same speed\nif((controls.left||controls.right)&&(controls.up||controls.down)){deltaX*=0.707;// sqrt(2)/2\ndeltaY*=0.707;}movePlayer(deltaX,deltaY);setGameState(prev=>({...prev,isMoving:true}));}else{setGameState(prev=>({...prev,isMoving:false}));}};moveIntervalRef.current=setInterval(gameLoop,16);// ~60fps\nreturn()=>{if(moveIntervalRef.current){clearInterval(moveIntervalRef.current);}};},[controls,movePlayer]);// Keyboard controls for desktop\nuseEffect(()=>{const handleKeyDown=e=>{switch(e.key){case'ArrowUp':case'w':case'W':e.preventDefault();setControls(prev=>({...prev,up:true}));break;case'ArrowDown':case's':case'S':e.preventDefault();setControls(prev=>({...prev,down:true}));break;case'ArrowLeft':case'a':case'A':e.preventDefault();setControls(prev=>({...prev,left:true}));break;case'ArrowRight':case'd':case'D':e.preventDefault();setControls(prev=>({...prev,right:true}));break;case' ':e.preventDefault();handleInteract();break;}};const handleKeyUp=e=>{switch(e.key){case'ArrowUp':case'w':case'W':setControls(prev=>({...prev,up:false}));break;case'ArrowDown':case's':case'S':setControls(prev=>({...prev,down:false}));break;case'ArrowLeft':case'a':case'A':setControls(prev=>({...prev,left:false}));break;case'ArrowRight':case'd':case'D':setControls(prev=>({...prev,right:false}));break;}};window.addEventListener('keydown',handleKeyDown);window.addEventListener('keyup',handleKeyUp);return()=>{window.removeEventListener('keydown',handleKeyDown);window.removeEventListener('keyup',handleKeyUp);};},[]);// Long-press to walk feature with better mobile handling\nconst[longPressTarget,setLongPressTarget]=useState(null);const longPressRef=useRef(null);const[touchStartTime,setTouchStartTime]=useState(null);const[isDPadActive,setIsDPadActive]=useState(false);// D-Pad control handlers\nconst handleDPadPress=direction=>{// Cancel any ongoing long-press when using D-Pad\nif(longPressRef.current){clearTimeout(longPressRef.current);longPressRef.current=null;}setLongPressTarget(null);// Cancel auto-walk\nsetControls(prev=>({...prev,[direction]:true}));};const handleDPadRelease=direction=>{setControls(prev=>({...prev,[direction]:false}));};// Improved touch handling to prevent context menu and conflicts\nconst handleDPadTouch=(direction,isStart,e)=>{e.stopPropagation();// Prevent bubbling to game area\ne.preventDefault();if(isStart){handleDPadPress(direction);}else{handleDPadRelease(direction);}};// Track if any D-Pad button is being used\nuseEffect(()=>{const isAnyDPadPressed=controls.up||controls.down||controls.left||controls.right;setIsDPadActive(isAnyDPadPressed);// Cancel long-press if D-Pad becomes active\nif(isAnyDPadPressed&&longPressRef.current){clearTimeout(longPressRef.current);longPressRef.current=null;setLongPressTarget(null);}},[controls]);const handleLongPress=e=>{// Don't start long-press if D-Pad is active\nif(isDPadActive)return;e.preventDefault();const touch=e.touches[0];const rect=gameRef.current.getBoundingClientRect();const screenX=touch.clientX-rect.left;const screenY=touch.clientY-rect.top;const worldX=screenX+camera.x;const worldY=screenY+camera.y;setTouchStartTime(Date.now());longPressRef.current=setTimeout(()=>{// Double-check D-Pad isn't active\nif(isDPadActive)return;// Vibration feedback if available\nif(navigator.vibrate){navigator.vibrate(50);}setLongPressTarget({x:worldX,y:worldY});},300);};const handleTouchEnd=e=>{e.preventDefault();const touchEndTime=Date.now();const touchDuration=touchEndTime-(touchStartTime||0);if(longPressRef.current){clearTimeout(longPressRef.current);longPressRef.current=null;}setTouchStartTime(null);};// Auto-walk to long-press target\nuseEffect(()=>{if(!longPressTarget)return;const autoWalk=()=>{const dx=longPressTarget.x-player.x;const dy=longPressTarget.y-player.y;const distance=Math.sqrt(dx*dx+dy*dy);if(distance<5){setLongPressTarget(null);return;}const moveSpeed=2;const moveX=dx/distance*moveSpeed;const moveY=dy/distance*moveSpeed;movePlayer(moveX,moveY);setGameState(prev=>({...prev,isMoving:true}));};const autoWalkInterval=setInterval(autoWalk,16);return()=>{clearInterval(autoWalkInterval);setGameState(prev=>({...prev,isMoving:false}));};},[longPressTarget,player.x,player.y,movePlayer]);// Chat system\nconst addChatMessage=function(message){let sender=arguments.length>1&&arguments[1]!==undefined?arguments[1]:player.username;const newMessage={id:Date.now(),sender,message,timestamp:new Date().toLocaleTimeString()};setGameState(prev=>({...prev,chatMessages:[...prev.chatMessages.slice(-4),newMessage]}));};// Activity system\nconst performActivity=type=>{const activities={fish:{xp:15,coins:25,energy:-10,message:\"You caught a fish! ðŸŸ\"},chop:{xp:12,coins:20,energy:-8,message:\"You chopped some wood! ðŸªµ\"},mine:{xp:18,coins:30,energy:-12,message:\"You found some ore! â›ï¸\"},cafe:{xp:5,coins:-10,energy:20,message:\"You enjoyed a coffee! â˜•\"}};const activity=activities[type];if(activity&&player.energy>=Math.abs(activity.energy)){setPlayer(prev=>({...prev,xp:prev.xp+activity.xp,coins:prev.coins+activity.coins,energy:Math.max(0,Math.min(100,prev.energy+activity.energy))}));addChatMessage(activity.message,'System');}else if(player.energy<Math.abs(activity.energy)){addChatMessage(\"You're too tired! Rest at the cafe to restore energy.\",'System');}};// Interaction system\nconst[nearbyInteractables,setNearbyInteractables]=useState([]);// Check for nearby interactive objects\nuseEffect(()=>{const interactionRange=80;// pixels\nconst nearby=[];// Check buildings\nbuildings.forEach(building=>{const distance=Math.sqrt(Math.pow(player.x-(building.x+building.width/2),2)+Math.pow(player.y-(building.y+building.height/2),2));if(distance<interactionRange){nearby.push({type:'building',id:building.id,name:building.name,emoji:building.emoji,action:getInteractionAction(building.id)});}});// Check NPCs\nnpcs.forEach(npc=>{const distance=Math.sqrt(Math.pow(player.x-npc.x,2)+Math.pow(player.y-npc.y,2));if(distance<interactionRange){nearby.push({type:'npc',id:npc.id,name:npc.name,emoji:npc.emoji,action:'Talk'});}});setNearbyInteractables(nearby);},[player.x,player.y,buildings,npcs]);// Get interaction action text\nconst getInteractionAction=buildingId=>{const actions={cafe:'Buy Coffee',shop:'Browse Shop',dock:'Fish',forest:'Chop Wood',mine:'Mine Ore',park:'Relax',townhall:'View Quests'};return actions[buildingId]||'Interact';};// Handle interaction\nconst handleInteract=()=>{if(nearbyInteractables.length===0)return;const target=nearbyInteractables[0];// Interact with closest/first\nif(target.type==='building'){interactWithBuilding(target.id);}else if(target.type==='npc'){const npc=npcs.find(n=>n.id===target.id);if(npc){addChatMessage(`${npc.dialogue}`,npc.name);}}};// Building interaction\nconst interactWithBuilding=buildingId=>{var _interactions$buildin;setUi(prev=>({...prev,selectedBuilding:buildingId}));const interactions={cafe:()=>{performActivity('cafe');// Check for coffee quest completion\nconst coffeeQuest=quests.find(q=>q.title==='Coffee Break'&&!q.completed);if(coffeeQuest){completeQuest(coffeeQuest.id);}},shop:()=>setUi(prev=>({...prev,showInventory:true})),dock:()=>{performActivity('fish');// Check for fishing quest completion\nconst fishingQuest=quests.find(q=>q.title==='Fishing Trip'&&!q.completed);if(fishingQuest){completeQuest(fishingQuest.id);}},forest:()=>performActivity('chop'),mine:()=>performActivity('mine'),park:()=>addChatMessage(\"You enjoy the peaceful park! ðŸŒ³\",'System'),townhall:()=>{setUi(prev=>({...prev,showQuests:true}));// Check for town hall quest completion\nconst townHallQuest=quests.find(q=>q.title==='First Steps'&&!q.completed);if(townHallQuest){completeQuest(townHallQuest.id);}}};(_interactions$buildin=interactions[buildingId])===null||_interactions$buildin===void 0?void 0:_interactions$buildin.call(interactions);};// Quest completion system\nconst completeQuest=questId=>{const quest=quests.find(q=>q.id===questId);if(quest&&!quest.completed){quest.completed=true;setPlayer(prev=>({...prev,coins:prev.coins+quest.reward.coins,xp:prev.xp+quest.reward.xp}));addChatMessage(`Quest completed: ${quest.title}! +${quest.reward.coins} coins, +${quest.reward.xp} XP`,'System');}};// Auto-dismiss welcome banner after movement\nuseEffect(()=>{if(gameState.isMoving&&ui.showWelcome){const timer=setTimeout(()=>{setUi(prev=>({...prev,showWelcome:false}));},3000);return()=>clearTimeout(timer);}},[gameState.isMoving,ui.showWelcome]);// Level up system\nuseEffect(()=>{const newLevel=Math.floor(player.xp/100)+1;if(newLevel>player.level){setPlayer(prev=>({...prev,level:newLevel}));addChatMessage(`Level up! You are now level ${newLevel}! ðŸŽ‰`,'System');}},[player.xp,player.level]);// Helper function to convert world coordinates to screen coordinates\nconst worldToScreen=(worldX,worldY)=>({x:worldX-camera.x,y:worldY-camera.y});// Check if an object is visible on screen\nconst isVisible=function(worldX,worldY){let width=arguments.length>2&&arguments[2]!==undefined?arguments[2]:60;let height=arguments.length>3&&arguments[3]!==undefined?arguments[3]:60;const screenPos=worldToScreen(worldX,worldY);return screenPos.x>-width&&screenPos.x<VIEWPORT_WIDTH&&screenPos.y>-height&&screenPos.y<VIEWPORT_HEIGHT;};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-screen bg-gradient-to-b from-sky-400 to-green-400 relative overflow-hidden font-sans touch-none select-none\",style:{touchAction:'none',userSelect:'none',WebkitUserSelect:'none',WebkitTouchCallout:'none',WebkitTapHighlightColor:'transparent'},onContextMenu:e=>e.preventDefault(),children:[/*#__PURE__*/_jsxs(\"div\",{ref:gameRef,className:\"relative w-full touch-none overflow-hidden select-none\",style:{height:`${VIEWPORT_HEIGHT}px`,touchAction:'none',userSelect:'none',WebkitUserSelect:'none',WebkitTouchCallout:'none'},onTouchStart:handleLongPress,onTouchEnd:handleTouchEnd,onTouchCancel:handleTouchEnd,onContextMenu:e=>e.preventDefault(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0\",style:{background:`\n              radial-gradient(circle at 25% 25%, rgba(135,206,235,0.3) 0%, transparent 50%),\n              radial-gradient(circle at 75% 75%, rgba(152,251,152,0.3) 0%, transparent 50%),\n              linear-gradient(to bottom, #87CEEB 0%, #98FB98 60%, #90EE90 100%)\n            `},children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-4xl opacity-40\",style:{left:200-camera.x,top:50-camera.y},children:\"\\u2601\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-3xl opacity-30\",style:{left:800-camera.x,top:80-camera.y},children:\"\\u2601\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-5xl opacity-25\",style:{left:1200-camera.x,top:30-camera.y},children:\"\\u2601\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-2xl\",style:{left:150-camera.x,top:900-camera.y},children:\"\\uD83C\\uDF38\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-2xl\",style:{left:600-camera.x,top:950-camera.y},children:\"\\uD83C\\uDF3A\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-xl\",style:{left:1000-camera.x,top:880-camera.y},children:\"\\uD83C\\uDF44\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute text-2xl\",style:{left:1400-camera.x,top:920-camera.y},children:\"\\uD83C\\uDF3B\"})]}),buildings.filter(building=>isVisible(building.x,building.y,building.width,building.height)).map(building=>{const screenPos=worldToScreen(building.x,building.y);const isNearby=nearbyInteractables.some(item=>item.type==='building'&&item.id===building.id);return/*#__PURE__*/_jsxs(\"div\",{className:`absolute rounded-lg shadow-lg transition-all duration-200 ${isNearby?'ring-4 ring-yellow-400 ring-opacity-70 scale-105':''}`,style:{left:screenPos.x,top:screenPos.y,width:building.width,height:building.height,backgroundColor:building.color},children:[/*#__PURE__*/_jsxs(\"div\",{className:`absolute -top-8 left-1/2 transform -translate-x-1/2 px-2 py-1 rounded text-xs whitespace-nowrap ${isNearby?'bg-yellow-500 text-black animate-pulse':'bg-black text-white'}`,children:[building.emoji,\" \",building.name]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center text-4xl\",children:building.emoji})]},building.id);}),npcs.filter(npc=>isVisible(npc.x,npc.y)).map(npc=>{const screenPos=worldToScreen(npc.x,npc.y);const isNearby=nearbyInteractables.some(item=>item.type==='npc'&&item.id===npc.id);return/*#__PURE__*/_jsxs(\"div\",{className:`absolute w-12 h-12 rounded-full bg-yellow-200 border-3 border-yellow-600 flex items-center justify-center shadow-md transition-all duration-200 ${isNearby?'ring-4 ring-blue-400 ring-opacity-70 scale-110 animate-pulse':''}`,style:{left:screenPos.x-24,top:screenPos.y-24},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:npc.emoji}),/*#__PURE__*/_jsx(\"div\",{className:`absolute -top-10 left-1/2 transform -translate-x-1/2 px-2 py-1 rounded text-xs whitespace-nowrap ${isNearby?'bg-blue-500 text-white animate-pulse':'bg-blue-600 text-white'}`,children:npc.name})]},npc.id);}),otherPlayers.filter(otherPlayer=>isVisible(otherPlayer.x,otherPlayer.y)).map(otherPlayer=>{const screenPos=worldToScreen(otherPlayer.x,otherPlayer.y);return/*#__PURE__*/_jsxs(\"div\",{className:\"absolute w-10 h-10 rounded-full bg-pink-200 border-2 border-pink-600 flex items-center justify-center shadow-md\",style:{left:screenPos.x-20,top:screenPos.y-20},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:otherPlayer.avatar}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-purple-600 text-white px-2 py-1 rounded text-xs whitespace-nowrap\",children:[otherPlayer.username,\" (Lv.\",otherPlayer.level,\")\"]})]},otherPlayer.id);}),/*#__PURE__*/_jsxs(\"div\",{className:`absolute w-12 h-12 rounded-full bg-blue-200 border-3 border-blue-600 flex items-center justify-center shadow-lg z-20 transition-all duration-100 animate-float ${gameState.isMoving?'scale-110 glow':''}`,style:{left:player.x-camera.x-24,top:player.y-camera.y-24},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:player.avatar}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-2 py-1 rounded text-xs whitespace-nowrap\",children:[player.username,\" (You)\"]})]}),longPressTarget&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute w-6 h-6 border-2 border-yellow-400 rounded-full bg-yellow-200 opacity-60 animate-pulse pointer-events-none glow-gold\",style:{left:longPressTarget.x-camera.x-12,top:longPressTarget.y-camera.y-12}}),nearbyInteractables.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 pointer-events-none\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75\",style:{left:Math.random()*VIEWPORT_WIDTH,top:Math.random()*VIEWPORT_HEIGHT,animationDelay:'0s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75\",style:{left:Math.random()*VIEWPORT_WIDTH,top:Math.random()*VIEWPORT_HEIGHT,animationDelay:'1s'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-0 left-0 right-0 bg-gradient-to-r from-purple-600 to-blue-600 text-white p-2 flex justify-between items-center text-sm z-30\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Coins,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:player.coins})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Star,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Lv.\",player.level]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 bg-white bg-opacity-20 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-400 h-2 rounded-full transition-all duration-300\",style:{width:`${player.xp%100}%`}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:gameState.onlinePlayers})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showMenu:!prev.showMenu})),className:\"p-1 rounded bg-white bg-opacity-20\",children:/*#__PURE__*/_jsx(Settings,{className:\"w-4 h-4\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-2 right-2 z-30\",style:{top:`${VIEWPORT_HEIGHT+8}px`},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Heart,{className:\"w-4 h-4 text-red-500\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-red-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500 h-2 rounded-full transition-all duration-300\",style:{width:`${player.energy}%`}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-white font-bold\",children:[player.energy,\"/100\"]})]})}),ui.showChat&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-2 right-2 bg-black bg-opacity-70 text-white p-2 rounded-lg max-h-20 overflow-y-auto text-xs z-30\",style:{top:`${VIEWPORT_HEIGHT+32}px`},children:gameState.chatMessages.map(msg=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-1\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-blue-300\",children:[msg.sender,\":\"]}),\" \",msg.message]},msg.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-0 left-0 right-0 p-3 flex justify-between items-end z-30\",children:[nearbyInteractables.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleInteract,className:\"w-16 h-16 bg-green-500 text-white rounded-full border-4 border-green-600 flex flex-col items-center justify-center shadow-lg animate-bounce active:bg-green-600 select-none\",style:{touchAction:'none',userSelect:'none',WebkitUserSelect:'none',WebkitTouchCallout:'none'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:nearbyInteractables[0].emoji}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:nearbyInteractables[0].action})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative ml-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-32 h-32\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-8 bg-gray-700 rounded-full opacity-50\"}),/*#__PURE__*/_jsx(\"button\",{className:\"absolute top-0 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-gray-600 rounded-t-full active:bg-gray-800 border-2 border-gray-800\",onTouchStart:e=>handleDPadTouch('up',true,e),onTouchEnd:e=>handleDPadTouch('up',false,e),onMouseDown:()=>handleDPadPress('up'),onMouseUp:()=>handleDPadRelease('up'),onMouseLeave:()=>handleDPadRelease('up'),style:{touchAction:'none'},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"\\u25B2\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-gray-600 rounded-b-full active:bg-gray-800 border-2 border-gray-800\",onTouchStart:e=>handleDPadTouch('down',true,e),onTouchEnd:e=>handleDPadTouch('down',false,e),onMouseDown:()=>handleDPadPress('down'),onMouseUp:()=>handleDPadRelease('down'),onMouseLeave:()=>handleDPadRelease('down'),style:{touchAction:'none'},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"\\u25BC\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"absolute left-0 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-gray-600 rounded-l-full active:bg-gray-800 border-2 border-gray-800\",onTouchStart:e=>handleDPadTouch('left',true,e),onTouchEnd:e=>handleDPadTouch('left',false,e),onMouseDown:()=>handleDPadPress('left'),onMouseUp:()=>handleDPadRelease('left'),onMouseLeave:()=>handleDPadRelease('left'),style:{touchAction:'none'},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"\\u25C0\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"absolute right-0 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-gray-600 rounded-r-full active:bg-gray-800 border-2 border-gray-800\",onTouchStart:e=>handleDPadTouch('right',true,e),onTouchEnd:e=>handleDPadTouch('right',false,e),onMouseDown:()=>handleDPadPress('right'),onMouseUp:()=>handleDPadRelease('right'),onMouseLeave:()=>handleDPadRelease('right'),style:{touchAction:'none'},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"\\u25B6\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-8 left-1/2 transform -translate-x-1/2 text-xs text-white bg-black bg-opacity-50 px-2 py-1 rounded whitespace-nowrap\",children:\"Hold to move\"})]})]}),ui.showWelcome&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-16 left-4 right-4 bg-white bg-opacity-90 rounded-lg p-3 shadow-lg z-40\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-purple-600 mb-1\",children:\"Welcome to Cozy Town! \\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-700\",children:\"Use the D-Pad to move or long-press anywhere to walk. Interact with buildings and NPCs to earn coins and XP!\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showWelcome:false})),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})}),ui.showMenu&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-12 right-2 bg-white rounded-lg shadow-lg p-2 space-y-1 z-40\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setUi(prev=>({...prev,showInventory:!prev.showInventory,showMenu:false})),className:\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\",children:[/*#__PURE__*/_jsx(ShoppingBag,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Inventory\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\",children:[/*#__PURE__*/_jsx(Home,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Home\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Friends\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showMiniMap:!prev.showMiniMap,showMenu:false})),className:\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Mini Map\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showQuests:!prev.showQuests,showMenu:false})),className:\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Quests\"})})]}),ui.showInventory&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 max-w-sm w-full mx-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold\",children:\"Inventory\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showInventory:false})),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:player.inventory.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"Your inventory is empty\"}):player.inventory.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-2 bg-gray-100 rounded\",children:[/*#__PURE__*/_jsx(\"span\",{children:item.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[\"x\",item.quantity]})]},index))})]})}),ui.showQuests&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 max-w-sm w-full mx-4 max-h-96 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold\",children:\"Quests\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setUi(prev=>({...prev,showQuests:false})),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:quests.map(quest=>/*#__PURE__*/_jsxs(\"div\",{className:`p-3 rounded border-2 ${quest.completed?'bg-green-50 border-green-300':'bg-gray-50 border-gray-300'}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:quest.title}),quest.completed&&/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 text-sm\",children:\"\\u2713 Completed\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:quest.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Reward: \",quest.reward.coins,\" coins, \",quest.reward.xp,\" XP\"]})]},quest.id))})]})}),ui.showMiniMap&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-16 left-2 bg-black bg-opacity-70 rounded-lg p-2 border-2 border-gray-600 z-40\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-32 h-24 bg-green-900\",children:[buildings.map(building=>/*#__PURE__*/_jsx(\"div\",{className:\"absolute bg-yellow-400\",style:{left:`${building.x/12.5}px`,top:`${building.y/12.5}px`,width:'3px',height:'3px'}},building.id)),/*#__PURE__*/_jsx(\"div\",{className:\"absolute w-2 h-2 bg-red-500 rounded-full animate-pulse\",style:{left:`${player.x/12.5-4}px`,top:`${player.y/12.5-4}px`}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-white mt-1\",children:\"World Map\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 left-2 text-xs text-white bg-black bg-opacity-50 p-1 rounded z-30\",children:[\"Pos: \",Math.round(player.x),\", \",Math.round(player.y),\" | Cam: \",Math.round(camera.x),\", \",Math.round(camera.y)]})]});};export default CozyTown;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Heart","MessageCircle","Star","Coins","Settings","Users","Home","ShoppingBag","Coffee","TreePine","Hammer","Fish","Sparkles","X","jsx","_jsx","jsxs","_jsxs","CozyTown","WORLD_WIDTH","WORLD_HEIGHT","VIEWPORT_WIDTH","VIEWPORT_HEIGHT","player","setPlayer","x","y","coins","level","xp","energy","avatar","username","friends","inventory","camera","setCamera","targetCameraRef","animationFrameRef","updateCamera","targetX","targetY","clampedTargetX","Math","max","min","clampedTargetY","current","smoothCameraUpdate","currentCamera","dx","dy","smoothing","newX","newY","abs","requestAnimationFrame","cancelAnimationFrame","ui","setUi","showChat","showInventory","showMenu","showQuests","selectedBuilding","showWelcome","showMiniMap","showSettings","gameState","setGameState","currentArea","time","weather","activeQuest","chatMessages","id","sender","message","timestamp","onlinePlayers","isMoving","soundEnabled","quests","title","description","reward","completed","npcs","name","emoji","dialogue","otherPlayers","gameRef","moveIntervalRef","controls","setControls","up","down","left","right","buildings","width","height","color","movePlayer","deltaX","deltaY","prev","moveSpeed","gameLoop","setInterval","clearInterval","handleKeyDown","e","key","preventDefault","handleInteract","handleKeyUp","window","addEventListener","removeEventListener","longPressTarget","setLongPressTarget","longPressRef","touchStartTime","setTouchStartTime","isDPadActive","setIsDPadActive","handleDPadPress","direction","clearTimeout","handleDPadRelease","handleDPadTouch","isStart","stopPropagation","isAnyDPadPressed","handleLongPress","touch","touches","rect","getBoundingClientRect","screenX","clientX","screenY","clientY","top","worldX","worldY","Date","now","setTimeout","navigator","vibrate","handleTouchEnd","touchEndTime","touchDuration","autoWalk","distance","sqrt","moveX","moveY","autoWalkInterval","addChatMessage","arguments","length","undefined","newMessage","toLocaleTimeString","slice","performActivity","type","activities","fish","chop","mine","cafe","activity","nearbyInteractables","setNearbyInteractables","interactionRange","nearby","forEach","building","pow","push","action","getInteractionAction","npc","buildingId","actions","shop","dock","forest","park","townhall","target","interactWithBuilding","find","n","_interactions$buildin","interactions","coffeeQuest","q","completeQuest","fishingQuest","townHallQuest","call","questId","quest","timer","newLevel","floor","worldToScreen","isVisible","screenPos","className","style","touchAction","userSelect","WebkitUserSelect","WebkitTouchCallout","WebkitTapHighlightColor","onContextMenu","children","ref","onTouchStart","onTouchEnd","onTouchCancel","background","filter","map","isNearby","some","item","backgroundColor","otherPlayer","random","animationDelay","onClick","msg","onMouseDown","onMouseUp","onMouseLeave","index","quantity","round"],"sources":["/Users/macbookpro2025/Cozy_Town/src/CozyTown.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Heart, MessageCircle, Star, Coins, Settings, Users, Home, ShoppingBag, Coffee, TreePine, Hammer, Fish, Sparkles, X } from 'lucide-react';\n\nconst CozyTown = () => {\n  // World dimensions - much larger than screen\n  const WORLD_WIDTH = 1600;\n  const WORLD_HEIGHT = 1200;\n  const VIEWPORT_WIDTH = 400;\n  const VIEWPORT_HEIGHT = 300;\n\n  const [player, setPlayer] = useState({\n    x: 600,\n    y: 400,\n    coins: 150,\n    level: 1,\n    xp: 0,\n    energy: 100,\n    avatar: 'ðŸ˜Š',\n    username: 'NewPlayer',\n    friends: 12,\n    inventory: []\n  });\n\n  const [camera, setCamera] = useState({\n    x: 600 - VIEWPORT_WIDTH / 2,\n    y: 400 - VIEWPORT_HEIGHT / 2\n  });\n\n  // Smooth camera following with interpolation\n  const targetCameraRef = useRef({ x: 600 - VIEWPORT_WIDTH / 2, y: 400 - VIEWPORT_HEIGHT / 2 });\n  const animationFrameRef = useRef(null);\n\n  // Camera follows player with smooth movement\n  useEffect(() => {\n    const updateCamera = () => {\n      const targetX = player.x - VIEWPORT_WIDTH / 2;\n      const targetY = player.y - VIEWPORT_HEIGHT / 2;\n      \n      // Clamp target camera to world bounds\n      const clampedTargetX = Math.max(0, Math.min(WORLD_WIDTH - VIEWPORT_WIDTH, targetX));\n      const clampedTargetY = Math.max(0, Math.min(WORLD_HEIGHT - VIEWPORT_HEIGHT, targetY));\n      \n      targetCameraRef.current = { x: clampedTargetX, y: clampedTargetY };\n    };\n    \n    updateCamera();\n  }, [player.x, player.y]);\n\n  // Smooth camera interpolation - more responsive\n  useEffect(() => {\n    const smoothCameraUpdate = () => {\n      setCamera(currentCamera => {\n        const dx = targetCameraRef.current.x - currentCamera.x;\n        const dy = targetCameraRef.current.y - currentCamera.y;\n        \n        // More responsive interpolation - increased from 0.12 to 0.25\n        const smoothing = 0.25;\n        const newX = currentCamera.x + (dx * smoothing);\n        const newY = currentCamera.y + (dy * smoothing);\n        \n        // Reduce threshold for stopping micro-movements - from 0.5 to 0.1\n        if (Math.abs(dx) < 0.1 && Math.abs(dy) < 0.1) {\n          return { x: targetCameraRef.current.x, y: targetCameraRef.current.y };\n        }\n        \n        return { x: newX, y: newY };\n      });\n      \n      animationFrameRef.current = requestAnimationFrame(smoothCameraUpdate);\n    };\n    \n    animationFrameRef.current = requestAnimationFrame(smoothCameraUpdate);\n    \n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    };\n  }, []);\n\n  const [ui, setUi] = useState({\n    showChat: true,\n    showInventory: false,\n    showMenu: false,\n    showQuests: false,\n    selectedBuilding: null,\n    showWelcome: true,\n    showMiniMap: false,\n    showSettings: false\n  });\n\n  const [gameState, setGameState] = useState({\n    currentArea: 'town_square',\n    time: 'day',\n    weather: 'sunny',\n    activeQuest: null,\n    chatMessages: [\n      { id: 1, sender: 'System', message: 'Welcome to Cozy Town! ðŸŒŸ', timestamp: '12:00' }\n    ],\n    onlinePlayers: 47,\n    isMoving: false,\n    soundEnabled: true\n  });\n\n  // Quest system\n  const [quests] = useState([\n    { id: 1, title: 'First Steps', description: 'Visit the Town Hall', reward: { coins: 50, xp: 20 }, completed: false },\n    { id: 2, title: 'Coffee Break', description: 'Buy coffee at the cafe', reward: { coins: 30, xp: 15 }, completed: false },\n    { id: 3, title: 'Fishing Trip', description: 'Catch a fish at the dock', reward: { coins: 100, xp: 50 }, completed: false }\n  ]);\n\n  // NPCs positioned in the larger world\n  const [npcs] = useState([\n    { id: 1, name: 'Mayor Jenkins', x: 800, y: 300, emoji: 'ðŸ‘¨â€ðŸ’¼', dialogue: \"Welcome to Cozy Town! We're always looking for new residents!\" },\n    { id: 2, name: 'Cafe Owner Luna', x: 300, y: 400, emoji: 'ðŸ‘©â€ðŸ³', dialogue: \"Fresh coffee and treats! Come in and relax!\" },\n    { id: 3, name: 'Shop Keeper Sam', x: 1200, y: 500, emoji: 'ðŸ›ï¸', dialogue: \"Come see my wares! I have everything you need!\" },\n    { id: 4, name: 'Fisher Bob', x: 200, y: 800, emoji: 'ðŸŽ£', dialogue: \"The fish are biting today! Want to try your luck?\" },\n    { id: 5, name: 'Woodcutter Alice', x: 1300, y: 200, emoji: 'ðŸª“', dialogue: \"Need some wood? I can teach you the trade!\" }\n  ]);\n\n  const [otherPlayers] = useState([\n    { id: 1, username: 'CoffeeLover23', x: 400, y: 450, avatar: 'â˜•', level: 5 },\n    { id: 2, username: 'TreeHugger', x: 900, y: 350, avatar: 'ðŸŒ±', level: 3 },\n    { id: 3, username: 'FishMaster', x: 250, y: 750, avatar: 'ðŸŸ', level: 8 },\n    { id: 4, username: 'Explorer99', x: 1100, y: 300, avatar: 'ðŸ—ºï¸', level: 6 }\n  ]);\n\n  const gameRef = useRef(null);\n  const moveIntervalRef = useRef(null);\n  const [controls, setControls] = useState({\n    up: false,\n    down: false,\n    left: false,\n    right: false\n  });\n\n  // Buildings positioned in the larger world\n  const buildings = [\n    { id: 'cafe', name: 'Cozy Cafe', x: 250, y: 350, width: 120, height: 100, emoji: 'â˜•', color: '#8B4513' },\n    { id: 'shop', name: 'General Store', x: 1150, y: 450, width: 140, height: 110, emoji: 'ðŸª', color: '#FF6B6B' },\n    { id: 'park', name: 'Central Park', x: 750, y: 150, width: 200, height: 160, emoji: 'ðŸŒ³', color: '#4ECDC4' },\n    { id: 'townhall', name: 'Town Hall', x: 700, y: 500, width: 160, height: 120, emoji: 'ðŸ›ï¸', color: '#45B7D1' },\n    { id: 'dock', name: 'Fishing Dock', x: 50, y: 700, width: 180, height: 100, emoji: 'ðŸŽ£', color: '#4682B4' },\n    { id: 'forest', name: 'Dark Forest', x: 1200, y: 100, width: 200, height: 180, emoji: 'ðŸŒ²', color: '#228B22' },\n    { id: 'mine', name: 'Crystal Mine', x: 1400, y: 800, width: 150, height: 120, emoji: 'â›ï¸', color: '#696969' }\n  ];\n\n  // Handle player movement with smooth continuous movement\n  const movePlayer = useCallback((deltaX, deltaY) => {\n    setPlayer(prev => {\n      const newX = Math.max(30, Math.min(WORLD_WIDTH - 30, prev.x + deltaX));\n      const newY = Math.max(30, Math.min(WORLD_HEIGHT - 30, prev.y + deltaY));\n      return { ...prev, x: newX, y: newY };\n    });\n  }, []);\n\n  // D-Pad movement system\n  useEffect(() => {\n    const moveSpeed = 3; // Pixels per frame\n    \n    const gameLoop = () => {\n      if (controls.up || controls.down || controls.left || controls.right) {\n        let deltaX = 0;\n        let deltaY = 0;\n        \n        if (controls.left) deltaX -= moveSpeed;\n        if (controls.right) deltaX += moveSpeed;\n        if (controls.up) deltaY -= moveSpeed;\n        if (controls.down) deltaY += moveSpeed;\n        \n        // Diagonal movement should be same speed\n        if ((controls.left || controls.right) && (controls.up || controls.down)) {\n          deltaX *= 0.707; // sqrt(2)/2\n          deltaY *= 0.707;\n        }\n        \n        movePlayer(deltaX, deltaY);\n        setGameState(prev => ({ ...prev, isMoving: true }));\n      } else {\n        setGameState(prev => ({ ...prev, isMoving: false }));\n      }\n    };\n\n    moveIntervalRef.current = setInterval(gameLoop, 16); // ~60fps\n    \n    return () => {\n      if (moveIntervalRef.current) {\n        clearInterval(moveIntervalRef.current);\n      }\n    };\n  }, [controls, movePlayer]);\n\n  // Keyboard controls for desktop\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      switch(e.key) {\n        case 'ArrowUp':\n        case 'w':\n        case 'W':\n          e.preventDefault();\n          setControls(prev => ({ ...prev, up: true }));\n          break;\n        case 'ArrowDown':\n        case 's':\n        case 'S':\n          e.preventDefault();\n          setControls(prev => ({ ...prev, down: true }));\n          break;\n        case 'ArrowLeft':\n        case 'a':\n        case 'A':\n          e.preventDefault();\n          setControls(prev => ({ ...prev, left: true }));\n          break;\n        case 'ArrowRight':\n        case 'd':\n        case 'D':\n          e.preventDefault();\n          setControls(prev => ({ ...prev, right: true }));\n          break;\n        case ' ':\n          e.preventDefault();\n          handleInteract();\n          break;\n      }\n    };\n\n    const handleKeyUp = (e) => {\n      switch(e.key) {\n        case 'ArrowUp':\n        case 'w':\n        case 'W':\n          setControls(prev => ({ ...prev, up: false }));\n          break;\n        case 'ArrowDown':\n        case 's':\n        case 'S':\n          setControls(prev => ({ ...prev, down: false }));\n          break;\n        case 'ArrowLeft':\n        case 'a':\n        case 'A':\n          setControls(prev => ({ ...prev, left: false }));\n          break;\n        case 'ArrowRight':\n        case 'd':\n        case 'D':\n          setControls(prev => ({ ...prev, right: false }));\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    window.addEventListener('keyup', handleKeyUp);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('keyup', handleKeyUp);\n    };\n  }, []);\n\n  // Long-press to walk feature with better mobile handling\n  const [longPressTarget, setLongPressTarget] = useState(null);\n  const longPressRef = useRef(null);\n  const [touchStartTime, setTouchStartTime] = useState(null);\n  const [isDPadActive, setIsDPadActive] = useState(false);\n\n  // D-Pad control handlers\n  const handleDPadPress = (direction) => {\n    // Cancel any ongoing long-press when using D-Pad\n    if (longPressRef.current) {\n      clearTimeout(longPressRef.current);\n      longPressRef.current = null;\n    }\n    setLongPressTarget(null); // Cancel auto-walk\n    setControls(prev => ({ ...prev, [direction]: true }));\n  };\n\n  const handleDPadRelease = (direction) => {\n    setControls(prev => ({ ...prev, [direction]: false }));\n  };\n\n  // Improved touch handling to prevent context menu and conflicts\n  const handleDPadTouch = (direction, isStart, e) => {\n    e.stopPropagation(); // Prevent bubbling to game area\n    e.preventDefault();\n    \n    if (isStart) {\n      handleDPadPress(direction);\n    } else {\n      handleDPadRelease(direction);\n    }\n  };\n\n  // Track if any D-Pad button is being used\n  useEffect(() => {\n    const isAnyDPadPressed = controls.up || controls.down || controls.left || controls.right;\n    setIsDPadActive(isAnyDPadPressed);\n    \n    // Cancel long-press if D-Pad becomes active\n    if (isAnyDPadPressed && longPressRef.current) {\n      clearTimeout(longPressRef.current);\n      longPressRef.current = null;\n      setLongPressTarget(null);\n    }\n  }, [controls]);\n\n  const handleLongPress = (e) => {\n    // Don't start long-press if D-Pad is active\n    if (isDPadActive) return;\n    \n    e.preventDefault();\n    const touch = e.touches[0];\n    const rect = gameRef.current.getBoundingClientRect();\n    const screenX = touch.clientX - rect.left;\n    const screenY = touch.clientY - rect.top;\n    const worldX = screenX + camera.x;\n    const worldY = screenY + camera.y;\n    \n    setTouchStartTime(Date.now());\n    \n    longPressRef.current = setTimeout(() => {\n      // Double-check D-Pad isn't active\n      if (isDPadActive) return;\n      \n      // Vibration feedback if available\n      if (navigator.vibrate) {\n        navigator.vibrate(50);\n      }\n      setLongPressTarget({ x: worldX, y: worldY });\n    }, 300);\n  };\n\n  const handleTouchEnd = (e) => {\n    e.preventDefault();\n    const touchEndTime = Date.now();\n    const touchDuration = touchEndTime - (touchStartTime || 0);\n    \n    if (longPressRef.current) {\n      clearTimeout(longPressRef.current);\n      longPressRef.current = null;\n    }\n    \n    setTouchStartTime(null);\n  };\n\n  // Auto-walk to long-press target\n  useEffect(() => {\n    if (!longPressTarget) return;\n    \n    const autoWalk = () => {\n      const dx = longPressTarget.x - player.x;\n      const dy = longPressTarget.y - player.y;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n      \n      if (distance < 5) {\n        setLongPressTarget(null);\n        return;\n      }\n      \n      const moveSpeed = 2;\n      const moveX = (dx / distance) * moveSpeed;\n      const moveY = (dy / distance) * moveSpeed;\n      \n      movePlayer(moveX, moveY);\n      setGameState(prev => ({ ...prev, isMoving: true }));\n    };\n    \n    const autoWalkInterval = setInterval(autoWalk, 16);\n    \n    return () => {\n      clearInterval(autoWalkInterval);\n      setGameState(prev => ({ ...prev, isMoving: false }));\n    };\n  }, [longPressTarget, player.x, player.y, movePlayer]);\n\n  // Chat system\n  const addChatMessage = (message, sender = player.username) => {\n    const newMessage = {\n      id: Date.now(),\n      sender,\n      message,\n      timestamp: new Date().toLocaleTimeString()\n    };\n    setGameState(prev => ({\n      ...prev,\n      chatMessages: [...prev.chatMessages.slice(-4), newMessage]\n    }));\n  };\n\n  // Activity system\n  const performActivity = (type) => {\n    const activities = {\n      fish: { xp: 15, coins: 25, energy: -10, message: \"You caught a fish! ðŸŸ\" },\n      chop: { xp: 12, coins: 20, energy: -8, message: \"You chopped some wood! ðŸªµ\" },\n      mine: { xp: 18, coins: 30, energy: -12, message: \"You found some ore! â›ï¸\" },\n      cafe: { xp: 5, coins: -10, energy: 20, message: \"You enjoyed a coffee! â˜•\" }\n    };\n\n    const activity = activities[type];\n    if (activity && player.energy >= Math.abs(activity.energy)) {\n      setPlayer(prev => ({\n        ...prev,\n        xp: prev.xp + activity.xp,\n        coins: prev.coins + activity.coins,\n        energy: Math.max(0, Math.min(100, prev.energy + activity.energy))\n      }));\n      addChatMessage(activity.message, 'System');\n    } else if (player.energy < Math.abs(activity.energy)) {\n      addChatMessage(\"You're too tired! Rest at the cafe to restore energy.\", 'System');\n    }\n  };\n\n  // Interaction system\n  const [nearbyInteractables, setNearbyInteractables] = useState([]);\n\n  // Check for nearby interactive objects\n  useEffect(() => {\n    const interactionRange = 80; // pixels\n    const nearby = [];\n\n    // Check buildings\n    buildings.forEach(building => {\n      const distance = Math.sqrt(\n        Math.pow(player.x - (building.x + building.width/2), 2) + \n        Math.pow(player.y - (building.y + building.height/2), 2)\n      );\n      if (distance < interactionRange) {\n        nearby.push({\n          type: 'building',\n          id: building.id,\n          name: building.name,\n          emoji: building.emoji,\n          action: getInteractionAction(building.id)\n        });\n      }\n    });\n\n    // Check NPCs\n    npcs.forEach(npc => {\n      const distance = Math.sqrt(\n        Math.pow(player.x - npc.x, 2) + \n        Math.pow(player.y - npc.y, 2)\n      );\n      if (distance < interactionRange) {\n        nearby.push({\n          type: 'npc',\n          id: npc.id,\n          name: npc.name,\n          emoji: npc.emoji,\n          action: 'Talk'\n        });\n      }\n    });\n\n    setNearbyInteractables(nearby);\n  }, [player.x, player.y, buildings, npcs]);\n\n  // Get interaction action text\n  const getInteractionAction = (buildingId) => {\n    const actions = {\n      cafe: 'Buy Coffee',\n      shop: 'Browse Shop',\n      dock: 'Fish',\n      forest: 'Chop Wood',\n      mine: 'Mine Ore',\n      park: 'Relax',\n      townhall: 'View Quests'\n    };\n    return actions[buildingId] || 'Interact';\n  };\n\n  // Handle interaction\n  const handleInteract = () => {\n    if (nearbyInteractables.length === 0) return;\n    \n    const target = nearbyInteractables[0]; // Interact with closest/first\n    \n    if (target.type === 'building') {\n      interactWithBuilding(target.id);\n    } else if (target.type === 'npc') {\n      const npc = npcs.find(n => n.id === target.id);\n      if (npc) {\n        addChatMessage(`${npc.dialogue}`, npc.name);\n      }\n    }\n  };\n\n  // Building interaction\n  const interactWithBuilding = (buildingId) => {\n    setUi(prev => ({ ...prev, selectedBuilding: buildingId }));\n    \n    const interactions = {\n      cafe: () => {\n        performActivity('cafe');\n        // Check for coffee quest completion\n        const coffeeQuest = quests.find(q => q.title === 'Coffee Break' && !q.completed);\n        if (coffeeQuest) {\n          completeQuest(coffeeQuest.id);\n        }\n      },\n      shop: () => setUi(prev => ({ ...prev, showInventory: true })),\n      dock: () => {\n        performActivity('fish');\n        // Check for fishing quest completion\n        const fishingQuest = quests.find(q => q.title === 'Fishing Trip' && !q.completed);\n        if (fishingQuest) {\n          completeQuest(fishingQuest.id);\n        }\n      },\n      forest: () => performActivity('chop'),\n      mine: () => performActivity('mine'),\n      park: () => addChatMessage(\"You enjoy the peaceful park! ðŸŒ³\", 'System'),\n      townhall: () => {\n        setUi(prev => ({ ...prev, showQuests: true }));\n        // Check for town hall quest completion\n        const townHallQuest = quests.find(q => q.title === 'First Steps' && !q.completed);\n        if (townHallQuest) {\n          completeQuest(townHallQuest.id);\n        }\n      }\n    };\n\n    interactions[buildingId]?.();\n  };\n\n  // Quest completion system\n  const completeQuest = (questId) => {\n    const quest = quests.find(q => q.id === questId);\n    if (quest && !quest.completed) {\n      quest.completed = true;\n      setPlayer(prev => ({\n        ...prev,\n        coins: prev.coins + quest.reward.coins,\n        xp: prev.xp + quest.reward.xp\n      }));\n      addChatMessage(`Quest completed: ${quest.title}! +${quest.reward.coins} coins, +${quest.reward.xp} XP`, 'System');\n    }\n  };\n\n  // Auto-dismiss welcome banner after movement\n  useEffect(() => {\n    if (gameState.isMoving && ui.showWelcome) {\n      const timer = setTimeout(() => {\n        setUi(prev => ({ ...prev, showWelcome: false }));\n      }, 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [gameState.isMoving, ui.showWelcome]);\n\n  // Level up system\n  useEffect(() => {\n    const newLevel = Math.floor(player.xp / 100) + 1;\n    if (newLevel > player.level) {\n      setPlayer(prev => ({ ...prev, level: newLevel }));\n      addChatMessage(`Level up! You are now level ${newLevel}! ðŸŽ‰`, 'System');\n    }\n  }, [player.xp, player.level]);\n\n  // Helper function to convert world coordinates to screen coordinates\n  const worldToScreen = (worldX, worldY) => ({\n    x: worldX - camera.x,\n    y: worldY - camera.y\n  });\n\n  // Check if an object is visible on screen\n  const isVisible = (worldX, worldY, width = 60, height = 60) => {\n    const screenPos = worldToScreen(worldX, worldY);\n    return screenPos.x > -width && screenPos.x < VIEWPORT_WIDTH &&\n           screenPos.y > -height && screenPos.y < VIEWPORT_HEIGHT;\n  };\n\n  return (\n    <div \n      className=\"w-full h-screen bg-gradient-to-b from-sky-400 to-green-400 relative overflow-hidden font-sans touch-none select-none\"\n      style={{ \n        touchAction: 'none',\n        userSelect: 'none',\n        WebkitUserSelect: 'none',\n        WebkitTouchCallout: 'none',\n        WebkitTapHighlightColor: 'transparent'\n      }}\n      onContextMenu={(e) => e.preventDefault()}\n    >\n      {/* Game Viewport */}\n      <div \n        ref={gameRef}\n        className=\"relative w-full touch-none overflow-hidden select-none\"\n        style={{ \n          height: `${VIEWPORT_HEIGHT}px`,\n          touchAction: 'none',\n          userSelect: 'none',\n          WebkitUserSelect: 'none',\n          WebkitTouchCallout: 'none'\n        }}\n        onTouchStart={handleLongPress}\n        onTouchEnd={handleTouchEnd}\n        onTouchCancel={handleTouchEnd}\n        onContextMenu={(e) => e.preventDefault()}\n      >\n        {/* World Background - scrolls with camera */}\n        <div \n          className=\"absolute inset-0\"\n          style={{\n            background: `\n              radial-gradient(circle at 25% 25%, rgba(135,206,235,0.3) 0%, transparent 50%),\n              radial-gradient(circle at 75% 75%, rgba(152,251,152,0.3) 0%, transparent 50%),\n              linear-gradient(to bottom, #87CEEB 0%, #98FB98 60%, #90EE90 100%)\n            `\n          }}\n        >\n          {/* Background decorations that scroll with world */}\n          <div className=\"absolute text-4xl opacity-40\" style={{ left: 200 - camera.x, top: 50 - camera.y }}>â˜ï¸</div>\n          <div className=\"absolute text-3xl opacity-30\" style={{ left: 800 - camera.x, top: 80 - camera.y }}>â˜ï¸</div>\n          <div className=\"absolute text-5xl opacity-25\" style={{ left: 1200 - camera.x, top: 30 - camera.y }}>â˜ï¸</div>\n          \n          {/* Ground elements */}\n          <div className=\"absolute text-2xl\" style={{ left: 150 - camera.x, top: 900 - camera.y }}>ðŸŒ¸</div>\n          <div className=\"absolute text-2xl\" style={{ left: 600 - camera.x, top: 950 - camera.y }}>ðŸŒº</div>\n          <div className=\"absolute text-xl\" style={{ left: 1000 - camera.x, top: 880 - camera.y }}>ðŸ„</div>\n          <div className=\"absolute text-2xl\" style={{ left: 1400 - camera.x, top: 920 - camera.y }}>ðŸŒ»</div>\n        </div>\n\n        {/* Buildings - only render if visible */}\n        {buildings.filter(building => isVisible(building.x, building.y, building.width, building.height)).map(building => {\n          const screenPos = worldToScreen(building.x, building.y);\n          const isNearby = nearbyInteractables.some(item => item.type === 'building' && item.id === building.id);\n          return (\n            <div\n              key={building.id}\n              className={`absolute rounded-lg shadow-lg transition-all duration-200 ${\n                isNearby ? 'ring-4 ring-yellow-400 ring-opacity-70 scale-105' : ''\n              }`}\n              style={{\n                left: screenPos.x,\n                top: screenPos.y,\n                width: building.width,\n                height: building.height,\n                backgroundColor: building.color,\n              }}\n            >\n              <div className={`absolute -top-8 left-1/2 transform -translate-x-1/2 px-2 py-1 rounded text-xs whitespace-nowrap ${\n                isNearby ? 'bg-yellow-500 text-black animate-pulse' : 'bg-black text-white'\n              }`}>\n                {building.emoji} {building.name}\n              </div>\n              <div className=\"w-full h-full flex items-center justify-center text-4xl\">\n                {building.emoji}\n              </div>\n            </div>\n          );\n        })}\n\n        {/* NPCs - only render if visible */}\n        {npcs.filter(npc => isVisible(npc.x, npc.y)).map(npc => {\n          const screenPos = worldToScreen(npc.x, npc.y);\n          const isNearby = nearbyInteractables.some(item => item.type === 'npc' && item.id === npc.id);\n          return (\n            <div\n              key={npc.id}\n              className={`absolute w-12 h-12 rounded-full bg-yellow-200 border-3 border-yellow-600 flex items-center justify-center shadow-md transition-all duration-200 ${\n                isNearby ? 'ring-4 ring-blue-400 ring-opacity-70 scale-110 animate-pulse' : ''\n              }`}\n              style={{ left: screenPos.x - 24, top: screenPos.y - 24 }}\n            >\n              <span className=\"text-xl\">{npc.emoji}</span>\n              <div className={`absolute -top-10 left-1/2 transform -translate-x-1/2 px-2 py-1 rounded text-xs whitespace-nowrap ${\n                isNearby ? 'bg-blue-500 text-white animate-pulse' : 'bg-blue-600 text-white'\n              }`}>\n                {npc.name}\n              </div>\n            </div>\n          );\n        })}\n\n        {/* Other Players - only render if visible */}\n        {otherPlayers.filter(otherPlayer => isVisible(otherPlayer.x, otherPlayer.y)).map(otherPlayer => {\n          const screenPos = worldToScreen(otherPlayer.x, otherPlayer.y);\n          return (\n            <div\n              key={otherPlayer.id}\n              className=\"absolute w-10 h-10 rounded-full bg-pink-200 border-2 border-pink-600 flex items-center justify-center shadow-md\"\n              style={{ left: screenPos.x - 20, top: screenPos.y - 20 }}\n            >\n              <span className=\"text-lg\">{otherPlayer.avatar}</span>\n              <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-purple-600 text-white px-2 py-1 rounded text-xs whitespace-nowrap\">\n                {otherPlayer.username} (Lv.{otherPlayer.level})\n              </div>\n            </div>\n          );\n        })}\n\n        {/* Player - always centered in view */}\n        <div\n          className={`absolute w-12 h-12 rounded-full bg-blue-200 border-3 border-blue-600 flex items-center justify-center shadow-lg z-20 transition-all duration-100 animate-float ${\n            gameState.isMoving ? 'scale-110 glow' : ''\n          }`}\n          style={{ \n            left: player.x - camera.x - 24,\n            top: player.y - camera.y - 24\n          }}\n        >\n          <span className=\"text-xl\">{player.avatar}</span>\n          <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-2 py-1 rounded text-xs whitespace-nowrap\">\n            {player.username} (You)\n          </div>\n        </div>\n\n        {/* Long-press target indicator */}\n        {longPressTarget && (\n          <div\n            className=\"absolute w-6 h-6 border-2 border-yellow-400 rounded-full bg-yellow-200 opacity-60 animate-pulse pointer-events-none glow-gold\"\n            style={{\n              left: longPressTarget.x - camera.x - 12,\n              top: longPressTarget.y - camera.y - 12\n            }}\n          />\n        )}\n\n        {/* Particle effects for interactions */}\n        {nearbyInteractables.length > 0 && (\n          <div className=\"absolute inset-0 pointer-events-none\">\n            <div className=\"absolute w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75\"\n              style={{\n                left: Math.random() * VIEWPORT_WIDTH,\n                top: Math.random() * VIEWPORT_HEIGHT,\n                animationDelay: '0s'\n              }}\n            />\n            <div className=\"absolute w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75\"\n              style={{\n                left: Math.random() * VIEWPORT_WIDTH,\n                top: Math.random() * VIEWPORT_HEIGHT,\n                animationDelay: '1s'\n              }}\n            />\n          </div>\n        )}\n      </div>\n\n      {/* Top UI Bar */}\n      <div className=\"absolute top-0 left-0 right-0 bg-gradient-to-r from-purple-600 to-blue-600 text-white p-2 flex justify-between items-center text-sm z-30\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"flex items-center space-x-1\">\n            <Coins className=\"w-4 h-4\" />\n            <span className=\"font-bold\">{player.coins}</span>\n          </div>\n          <div className=\"flex items-center space-x-1\">\n            <Star className=\"w-4 h-4\" />\n            <span>Lv.{player.level}</span>\n          </div>\n          <div className=\"w-16 bg-white bg-opacity-20 rounded-full h-2\">\n            <div \n              className=\"bg-yellow-400 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${(player.xp % 100)}%` }}\n            />\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <div className=\"flex items-center space-x-1\">\n            <Users className=\"w-4 h-4\" />\n            <span className=\"text-sm\">{gameState.onlinePlayers}</span>\n          </div>\n          <button\n            onClick={() => setUi(prev => ({ ...prev, showMenu: !prev.showMenu }))}\n            className=\"p-1 rounded bg-white bg-opacity-20\"\n          >\n            <Settings className=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Energy Bar */}\n      <div className=\"absolute left-2 right-2 z-30\" style={{ top: `${VIEWPORT_HEIGHT + 8}px` }}>\n        <div className=\"flex items-center space-x-2\">\n          <Heart className=\"w-4 h-4 text-red-500\" />\n          <div className=\"flex-1 bg-red-200 rounded-full h-2\">\n            <div \n              className=\"bg-red-500 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${player.energy}%` }}\n            />\n          </div>\n          <span className=\"text-xs text-white font-bold\">{player.energy}/100</span>\n        </div>\n      </div>\n\n      {/* Chat System */}\n      {ui.showChat && (\n        <div className=\"absolute left-2 right-2 bg-black bg-opacity-70 text-white p-2 rounded-lg max-h-20 overflow-y-auto text-xs z-30\" style={{ top: `${VIEWPORT_HEIGHT + 32}px` }}>\n          {gameState.chatMessages.map(msg => (\n            <div key={msg.id} className=\"mb-1\">\n              <span className=\"font-bold text-blue-300\">{msg.sender}:</span> {msg.message}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Bottom Controls Container */}\n      <div className=\"absolute bottom-0 left-0 right-0 p-3 flex justify-between items-end z-30\">\n        {/* Interact Button - Context Sensitive */}\n        {nearbyInteractables.length > 0 && (\n          <div className=\"flex flex-col items-center\">\n            <button\n              onClick={handleInteract}\n              className=\"w-16 h-16 bg-green-500 text-white rounded-full border-4 border-green-600 flex flex-col items-center justify-center shadow-lg animate-bounce active:bg-green-600 select-none\"\n              style={{ \n                touchAction: 'none',\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                WebkitTouchCallout: 'none'\n              }}\n            >\n              <span className=\"text-2xl\">{nearbyInteractables[0].emoji}</span>\n              <span className=\"text-xs\">{nearbyInteractables[0].action}</span>\n            </button>\n          </div>\n        )}\n\n        {/* D-Pad Controller */}\n        <div className=\"relative ml-auto\">\n          <div className=\"relative w-32 h-32\">\n            {/* Center circle */}\n            <div className=\"absolute inset-8 bg-gray-700 rounded-full opacity-50\" />\n            \n            {/* Up button */}\n            <button\n              className=\"absolute top-0 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-gray-600 rounded-t-full active:bg-gray-800 border-2 border-gray-800\"\n              onTouchStart={(e) => handleDPadTouch('up', true, e)}\n              onTouchEnd={(e) => handleDPadTouch('up', false, e)}\n              onMouseDown={() => handleDPadPress('up')}\n              onMouseUp={() => handleDPadRelease('up')}\n              onMouseLeave={() => handleDPadRelease('up')}\n              style={{ touchAction: 'none' }}\n            >\n              <span className=\"text-white\">â–²</span>\n            </button>\n            \n            {/* Down button */}\n            <button\n              className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-gray-600 rounded-b-full active:bg-gray-800 border-2 border-gray-800\"\n              onTouchStart={(e) => handleDPadTouch('down', true, e)}\n              onTouchEnd={(e) => handleDPadTouch('down', false, e)}\n              onMouseDown={() => handleDPadPress('down')}\n              onMouseUp={() => handleDPadRelease('down')}\n              onMouseLeave={() => handleDPadRelease('down')}\n              style={{ touchAction: 'none' }}\n            >\n              <span className=\"text-white\">â–¼</span>\n            </button>\n            \n            {/* Left button */}\n            <button\n              className=\"absolute left-0 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-gray-600 rounded-l-full active:bg-gray-800 border-2 border-gray-800\"\n              onTouchStart={(e) => handleDPadTouch('left', true, e)}\n              onTouchEnd={(e) => handleDPadTouch('left', false, e)}\n              onMouseDown={() => handleDPadPress('left')}\n              onMouseUp={() => handleDPadRelease('left')}\n              onMouseLeave={() => handleDPadRelease('left')}\n              style={{ touchAction: 'none' }}\n            >\n              <span className=\"text-white\">â—€</span>\n            </button>\n            \n            {/* Right button */}\n            <button\n              className=\"absolute right-0 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-gray-600 rounded-r-full active:bg-gray-800 border-2 border-gray-800\"\n              onTouchStart={(e) => handleDPadTouch('right', true, e)}\n              onTouchEnd={(e) => handleDPadTouch('right', false, e)}\n              onMouseDown={() => handleDPadPress('right')}\n              onMouseUp={() => handleDPadRelease('right')}\n              onMouseLeave={() => handleDPadRelease('right')}\n              style={{ touchAction: 'none' }}\n            >\n              <span className=\"text-white\">â–¶</span>\n            </button>\n          </div>\n          \n          {/* D-Pad hint */}\n          <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 text-xs text-white bg-black bg-opacity-50 px-2 py-1 rounded whitespace-nowrap\">\n            Hold to move\n          </div>\n        </div>\n      </div>\n\n      {/* Welcome Banner */}\n      {ui.showWelcome && (\n        <div className=\"absolute top-16 left-4 right-4 bg-white bg-opacity-90 rounded-lg p-3 shadow-lg z-40\">\n          <div className=\"flex justify-between items-start\">\n            <div>\n              <h2 className=\"text-lg font-bold text-purple-600 mb-1\">Welcome to Cozy Town! ðŸŒŸ</h2>\n              <p className=\"text-sm text-gray-700\">\n                Use the D-Pad to move or long-press anywhere to walk. Interact with buildings and NPCs to earn coins and XP!\n              </p>\n            </div>\n            <button\n              onClick={() => setUi(prev => ({ ...prev, showWelcome: false }))}\n              className=\"text-gray-500 hover:text-gray-700\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Quick Actions Menu */}\n      {ui.showMenu && (\n        <div className=\"absolute top-12 right-2 bg-white rounded-lg shadow-lg p-2 space-y-1 z-40\">\n          <button \n            onClick={() => setUi(prev => ({ ...prev, showInventory: !prev.showInventory, showMenu: false }))}\n            className=\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\"\n          >\n            <ShoppingBag className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Inventory</span>\n          </button>\n          <button className=\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\">\n            <Home className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Home</span>\n          </button>\n          <button className=\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\">\n            <Users className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Friends</span>\n          </button>\n          <button \n            onClick={() => setUi(prev => ({ ...prev, showMiniMap: !prev.showMiniMap, showMenu: false }))}\n            className=\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\"\n          >\n            <span className=\"text-sm\">Mini Map</span>\n          </button>\n          <button \n            onClick={() => setUi(prev => ({ ...prev, showQuests: !prev.showQuests, showMenu: false }))}\n            className=\"flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded\"\n          >\n            <span className=\"text-sm\">Quests</span>\n          </button>\n        </div>\n      )}\n\n      {/* Inventory Modal */}\n      {ui.showInventory && (\n        <div className=\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-4 max-w-sm w-full mx-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-lg font-bold\">Inventory</h2>\n              <button\n                onClick={() => setUi(prev => ({ ...prev, showInventory: false }))}\n                className=\"text-gray-500 hover:text-gray-700\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n            <div className=\"space-y-2\">\n              {player.inventory.length === 0 ? (\n                <p className=\"text-gray-500 text-center py-4\">Your inventory is empty</p>\n              ) : (\n                player.inventory.map((item, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-2 bg-gray-100 rounded\">\n                    <span>{item.name}</span>\n                    <span className=\"text-sm text-gray-600\">x{item.quantity}</span>\n                  </div>\n                ))\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Quests Modal */}\n      {ui.showQuests && (\n        <div className=\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-4 max-w-sm w-full mx-4 max-h-96 overflow-y-auto\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-lg font-bold\">Quests</h2>\n              <button\n                onClick={() => setUi(prev => ({ ...prev, showQuests: false }))}\n                className=\"text-gray-500 hover:text-gray-700\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n            <div className=\"space-y-3\">\n              {quests.map(quest => (\n                <div key={quest.id} className={`p-3 rounded border-2 ${quest.completed ? 'bg-green-50 border-green-300' : 'bg-gray-50 border-gray-300'}`}>\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <h3 className=\"font-semibold\">{quest.title}</h3>\n                    {quest.completed && <span className=\"text-green-600 text-sm\">âœ“ Completed</span>}\n                  </div>\n                  <p className=\"text-sm text-gray-600 mb-2\">{quest.description}</p>\n                  <div className=\"text-xs text-gray-500\">\n                    Reward: {quest.reward.coins} coins, {quest.reward.xp} XP\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Mini Map */}\n      {ui.showMiniMap && (\n        <div className=\"absolute top-16 left-2 bg-black bg-opacity-70 rounded-lg p-2 border-2 border-gray-600 z-40\">\n          <div className=\"relative w-32 h-24 bg-green-900\">\n            {/* Map scale: 1px = 12.5 world units */}\n            {buildings.map(building => (\n              <div\n                key={building.id}\n                className=\"absolute bg-yellow-400\"\n                style={{\n                  left: `${building.x / 12.5}px`,\n                  top: `${building.y / 12.5}px`,\n                  width: '3px',\n                  height: '3px'\n                }}\n              />\n            ))}\n            {/* Player position */}\n            <div\n              className=\"absolute w-2 h-2 bg-red-500 rounded-full animate-pulse\"\n              style={{\n                left: `${player.x / 12.5 - 4}px`,\n                top: `${player.y / 12.5 - 4}px`\n              }}\n            />\n          </div>\n          <div className=\"text-xs text-white mt-1\">World Map</div>\n        </div>\n      )}\n\n      {/* Debug Info (remove in production) */}\n      <div className=\"absolute top-2 left-2 text-xs text-white bg-black bg-opacity-50 p-1 rounded z-30\">\n        Pos: {Math.round(player.x)}, {Math.round(player.y)} | Cam: {Math.round(camera.x)}, {Math.round(camera.y)}\n      </div>\n    </div>\n  );\n};\n\nexport default CozyTown; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}